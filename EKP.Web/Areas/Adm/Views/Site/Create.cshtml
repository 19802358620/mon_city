<div class="row">
    <div class="col-md-12">
        <div class="portlet light min-height500">
            <div class="portlet-title">
                <div class="caption">
                    <i class="fa fa-plus"></i>
                    <span class="caption-subject font-green-sharp bold uppercase">新建站点</span>
                </div>
            </div>
            <div class="portlet-body form">
                <form action="javascript:;" class="form-horizontal" id="site">
                    <input type="text" class="form-control" name="ParentId" style="display: none" />
                    <input type="text" class="form-control" name="Type" value="Substation" style="display: none" />
                    <div class="form-body">
                        <h3 class="form-section">站点信息</h3>
                        <div class="form-group">
                            <label class="control-label col-md-3"><span class="required"> * </span>站点名称：</label>
                            <div class="col-md-6">
                                <input type="text" class="form-control" name="Name" placeholder="请填写站点名称" />
                                <label for="Name"></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-3"><span class="required"> * </span>站点目录：</label>
                            <div class="col-md-6">
                                <input type="text" class="form-control" name="Domain" />
                                <label for="Name"></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-3">省市：</label>
                            <div class="col-md-6 keImage">
                                <select class="width100 form-control" id="Site_create_Province" name="Site.create.Province"></select>&nbsp;
                                <select class="width100 form-control" id="Site_create_City" name="Site.create.City"></select>
                            </div>
                        </div>
                        <div class="form-group CoverImg">
                            <label class="control-label col-md-3">Logo：</label>
                            <div class="col-md-6 keImage">
                                <img class="bg-img" style="max-width: 500px; border: 1px solid gainsboro;margin-bottom: 5px;" id="imgPicture" />
                                <div class="input-group">
                                    <div class="">
                                        <input type="text" name="Logo" class="form-control" readonly="readonly">
                                    </div>
                                    <span class="input-group-btn">
                                        <button type="button" class="btn blue" id="btnPicture"><i class="fa fa-photo"></i> 浏览</button>
                                    </span>
                                </div>
                                <div class="text-align-left">
                                    <label class="help-block">推荐尺寸：500 * 50</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group CoverImg">
                            <label class="control-label col-md-3">Favicon：</label>
                            <div class="col-md-6 keImage">
                                <img style="max-width: 64px; margin-bottom: 5px" id="imgPicture2" />
                                <div class="input-group">
                                    <div class="">
                                        <input type="text" name="Favicon" class="form-control" readonly="readonly">
                                    </div>
                                    <span class="input-group-btn">
                                        <button type="button" class="btn blue" id="btnPicture2"><i class="fa fa-photo"></i> 浏览</button>
                                    </span>
                                </div>
                                <div class="text-align-left">
                                    <label class="help-block">推荐尺寸：32 * 32</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group CoverImg">
                            <label class="control-label col-md-3">横幅：</label>
                            <div class="col-md-6 keImage">
                                <img class="bg-img" style="max-width: 600px; margin-bottom: 5px" id="imgPicture3" />
                                <div class="input-group">
                                    <div class="">
                                        <input type="text" name="TopBanner" class="form-control" readonly="readonly">
                                    </div>
                                    <span class="input-group-btn">
                                        <button type="button" class="btn blue" id="btnPicture3"><i class="fa fa-photo"></i> 浏览</button>
                                    </span>
                                </div>
                                <div class="text-align-left">
                                    <label class="help-block">推荐尺寸：1450 * 140</label>
                                </div>
                            </div>
                        </div>
                        <h3 class="form-section">关于平台</h3>
                        <div class="form-group">
                            <label class="control-label col-md-3">电话：</label>
                            <div class="col-md-6">
                                <input type="text" class="form-control" name="Telephone" />
                                <label for="Telephone"></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-3">传真：</label>
                            <div class="col-md-6">
                                <input type="text" class="form-control" name="Fax" />
                                <label for="Fax"></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-3">Email：</label>
                            <div class="col-md-6">
                                <input type="text" class="form-control" name="Email" />
                                <label for="Email"></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-3">基金资助：</label>
                            <div class="col-md-6">
                                <textarea class="form-control" name="FundSupport" rows="3"></textarea>
                                <label for="Technical"></label>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-3">技术支持：</label>
                            <div class="col-md-6">
                                <textarea class="form-control" name="Technical" rows="3"></textarea>
                                <label for="Technical"></label>
                            </div>
                        </div>
                        <div class="form-group CoverImg">
                            <label class="control-label col-md-3">企业微信公众号：</label>
                            <div class="col-md-6 keImage">
                                <img class="bg-img" style="width:150px;height:150px;margin-bottom:5px;" id="imgPicture4" />
                                <div class="input-group">
                                    <div class="">
                                        <input type="text" name="EnWeChat" class="form-control" readonly="readonly">
                                    </div>
                                    <span class="input-group-btn">
                                        <button type="button" class="btn blue" id="btnPicture4"><i class="fa fa-photo"></i> 浏览</button>
                                    </span>
                                </div>
                                <div class="text-align-left">
                                    <label class="help-block">推荐尺寸：150 * 150</label>
                                </div>
                            </div>
                        </div>
                        <div class="form-group">
                            <label class="control-label col-md-3">版权所有：</label>
                            <div class="col-md-8">
                                <input class="kindeditor form-control" name="Copyright" style="height:150px;" />
                            </div>
                        </div>
                    </div>
                    <div class="form-actions">
                        <div class="row">
                            <div class="col-md-offset-3 col-md-9">
                                <button type="button" class="btn blue" onclick="btnSave()">
                                    <i class="fa fa-save"></i>
                                    保存
                                </button>
                                <button type="button" class="btn default" onclick="btnBack()">
                                    <i class="fa fa-mail-reply"></i>
                                    返回
                                </button>
                            </div>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>
@section  body_js{
    <script>
        var menu = gloQs.menu;

        //初始化
        $(function () {
            Metronic.init();
            Layout.init();
            admLayout({ menuName: menu, title: "新建站点" });

            //插件
            $(document).area("Site_create_Province", "Site_create_City");//初始化省市联动
            $("#Site_create_Province").trigger("change");
            $("#Site_create_Province").select2();
            $("#Site_create_City").select2();
            KeHelper.create('.kindeditor');
            KeHelper.createImage('.keImage');

            //初始化表单值
            $("#site *[name='ParentId']").val(appInfo.site.Id);

            //验证
            $('#site').formValidation({
                fields: {
                    "Name": {
                        validators: {
                            notEmpty: {
                                message: '* 该项为必填项.'
                            }
                        }
                    },
                    "Domain": {
                        validators: {
                            notEmpty: {
                                message: '* 该项为必填项.'
                            }
                        }
                    }
                }
            });
        });

        //保存
        function btnSave() {
            //同步Kindeditor内容
            for (var i in KindEditor.instances) {
                if (KindEditor.instances.hasOwnProperty(i)) {
                    KindEditor.instances[i].sync();
                }
            }

            if (!$('#site').formValidation("validate").data("formValidation").isValid()) return;

            $.ajax({
                type: "post",
                dataType: "json",
                data: $('#site').serialize(),
                url: getUrl("site", "Create"),
                success: function (data) {
                    $dialogShow(data);

                    if (data.Type == "Success") {
                        setTimeout(function () {
                            btnBack();
                        }, 500);
                    }
                }
            });
        }

        //返回
        function btnBack() {
            window.location.href = gloQs.returnUrl;
        }
    </script>
}